# Writeup 8 - Binaries II

Name: Cooper Willetts
Section: 0101

I pledge on my honor that I have not given or received any unauthorized assistance on this assignment or examination.

Digital acknowledgement: Cooper Willetts 

## Assignment Writeup

### Part 1 (100 pts)
Answer the following questions regarding the server executable (for which source is provided).

1. How is the per-session administrator password generated? Are there any inherent weaknesses in this implementation?

- The per-session password is generated by a random character based on a given length. This leads to very exotic password that would be difficult to perdict. The inherent weakness in this implementation is where the password is being stored, on the stack. 

2. Describe two vulnerabilities in this program. Provide specific line numbers and classifications of the vulnerability. Explain potential ramifications as well as ways to avoid these vulnerabilities when writing code.

- One of the vulnerabilties in this program is that the user has the ability to input string formatters (Line 46), this allows the user to view contents on the stack by using specialized inputs. One way to avoid this vulnerability is to add a check to ensure the string trying to be encypted is not one of the string formatters that could yield access to the stack. 

- Another vulnerability within the program is the use of 'gets' which does not limit the amount of input information received (line 68), this can lead to overwriting of other variables unintentionally. This vulnerability could be fixed by using fgets. 

3. What is the flag?

 - CMSC389R-{expl017-2-w1n}

4. Describe the process you followed to obtain the flag: vulnerabilities exploited, your inputs to the server in a human-readable format, etc. If you create any helper code please include it.

-In order to obtain the flag, the first step was to gain admin status on the server. To do this, we need to make use of the printf string format vulnerability. We needed to view the password, which was stored on the stack. Using GDB we could find the memory location of the password. Then if we choose to encrypt, then use %k (%x) we get a value at memory location in the stack. We can then input various values in the input to see where our current memory location is at. We then substract the position of the current address from the password, then divide by 4 to get our needed offset. Now that we have found the offset, we can use %offset$f (%offset$s) to get our password to print out, out actual offset and command is '%29$f'. 

-Now that we have admin privledges, we need to execute a command to view the flag file, but in order to do that we need to add our needed command to the commands string. We do this by using buffer overflow, putting in extra information so that it overflows into the commands string and then we can execute our wanted command. I was able to do this by padding our wanted command 'cat flag' with spaces, then adding this new command into the commands string. Since the input buff is of size 32, we have 32 chars to fill. 'cat flag' is 8 char, we need to pad it with 24 spaces to the left. Now, everything after the 'g' in flag will overflow into the commmand string, so we just put another 24 spaces ending with 'cat flag'. Now our wanted command is found within the command string, and is executed, which prints the flag. 
